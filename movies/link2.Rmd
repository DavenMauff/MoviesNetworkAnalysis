---
title: "Questions"
author: "Luciaaaa"
date: "03/09/2019"
output: html_document
---

```{r setup, include=FALSE}
library(pacman)
pacman::p_load(dplyr, ggplot2, tidyr )
knitr::opts_chunk$set(echo = TRUE)
setwd(getwd())
```

```{r}
movie_metadata <- read.csv("../data/movie_metadata.csv", sep=";")
```

```{r}
movie_metadata<- movie_metadata %>% 
  mutate(profit = gross - budget,
         return_on_investment_perc = (profit/budget)*100)
```

### Link 2: https://rpubs.com/jasmine36/234304

Problem Statement Since there is no universal way to claim the goodness of a movie, one could rely on the parameters like critic ratings, profit earned, viewers likes and ratings etc.

Implementation Since the data has information about the year of its release, budget, gross earnings, director name of the movie etc, I would be working on these aspects to analyze the success of movies and directors over the years.

Summary Several trends have been seen between the budget, profit earned, and it’s Return on Investment. Analysis has also been done to figure out the most successful directors and the most favorite genres among directors and producers.

-----

1. Most Successfull Directors [ ]
> Director vs FB likes
> Director VS Gross
> Director VS Imdb
> Average Profit VS Number of Films (Points being Director)


```{r}
#Top 20 most successful directors
movie_metadata %>%
        group_by(director_name) %>%
  mutate(profit = gross - budget)%>%
select(director_name, budget, gross, profit) %>%
na.omit() %>% 
summarise(films = n(), budget = sum(as.numeric(budget)), gross = sum(as.numeric(gross)), profit = sum(as.numeric(profit))) %>%
mutate(avg_per_film = profit/films) %>%
arrange(desc(avg_per_film)) %>% 
top_n(20, avg_per_film) %>%
ggplot( aes(x = films, y = avg_per_film/1000000)) + 
geom_point(size = 1, color = "blue") + 
geom_text_repel(aes(label = director_name), size = 3, color = "blue") + 
xlab("Number of Films") + ylab("Avg Profit $millions") + 
ggtitle("Most Successful Directors")
```
These are the top 20 most successful directors based on the average profit earned by the movies they directed.

There’s an obvious downward trend between average profit and number of films. This could be because as one makes more movies, one could have more hits and misses, therefore the average goes down. It could also be due to film makers having a more diverse range of movies which could include smaller and/or high budget movies"


2. Top 20 movies based on its Profit

```{r}
#Top 20 movies based on its Profit
movie_metadata %>% 
  filter(title_year %in% c(2000:2016)) %>%
  mutate(profit = gross - budget,
         return_on_investment_perc = (profit/budget)*100) %>%
  arrange(desc(profit)) %>% 
  top_n(20, profit) %>%
  ggplot(aes(x=budget/1000000, y=profit/1000000)) + 
  geom_point(size = 2) + 
  geom_smooth(size = 1) + 
  geom_text_repel(aes(label = movie_title), size = 3) + 
  xlab("Budget $million") + 
  ylab("Profit $million") + 
  ggtitle("20 Most Profitable Movies")
```

2. Top 20 movies based on its Return on Investment
```{r}
#Top 20 movies based on its Return on Investment
movie_metadata %>% 
  filter(budget >100000) %>%
  mutate(profit = gross - budget,
         return_on_investment_perc = (profit/budget)*100) %>%
  arrange(desc(profit)) %>% 
  top_n(20, profit) %>%
  ggplot(aes(x=budget/1000000, y=return_on_investment_perc)) + 
  geom_point(size = 2) + 
  geom_smooth(size = 1) + 
  geom_text_repel(aes(label = movie_title), size = 3) + 
  xlab("Budget $million") + 
  ylab("Percent Return on Investment") + 
  ggtitle("20 Most Profitable Movies based on its Return on Investment")
```

These are the top 20 movies based on its Percentage Return on Investment. ((profit/budget)*100).
Since profit earned by a movie does not give a clear picture about its monetary success over the years (1916 to 2016), this analyses, over the absolute value of the Return on Investment(ROI) across its Budget, would provide better results.
As hypothesized, the ROI is high for Low Budget Films and decreases as the budget of the movie increases.


2. Commercial Success VS Critical Acclaim [ ]
> Gross Money VS Imdb score (Profit being size of point; Point Colour being rating)
> Also available on: http://rstudio-pubs-static.s3.amazonaws.com/342210_7c8d57cfdd784cf58dc077d3eb7a2ca3.html

```{r}
movie_metadata %>%
  filter(imdb_score >5 ) %>% #Filter to show the graph only for vote_average values greater than 5
 ggplot(aes(x = imdb_score, y = (gross-budget))) + #ROI == gross - budget #LUCIA PLEASE FIX:)
  geom_point(alpha = 0.5, col = "darkgreen") + 
  theme(axis.text.x=element_text(hjust=1))+
  ggtitle("ROI Vs avg_rating")+
  xlab("rating ")+
  ylab("") +
  geom_smooth()
```


```{r}
movie_metadata %>%
  top_n(15, profit) %>%
  ggplot(aes(x = imdb_score, y = gross/10^6, size = profit/10^6, color = content_rating)) + 
  geom_point() + 
  geom_hline(aes(yintercept = 600)) + 
  geom_vline(aes(xintercept = 7.75)) + 
  geom_text_repel(aes(label = movie_title), size = 4) +
  xlab("Imdb score") + 
  ylab("Gross money earned in million dollars") + 
  ggtitle("Commercial success Vs Critical acclaim") +
  annotate("text", x = 8.5, y = 700, label = "High ratings \n & High gross") +
  theme(plot.title = element_text(hjust = 0.5))
```
This is an analysis on the Commercial Success acclaimed by the movie (Gross earnings and profit earned) vs its IMDB Score.

As expected, there is not much correlation since most critically acclaimed movies do not do much well commercially.

Top 20 genres with the most movies
```{r}
genre = movie_metadata['genres']
genre = data.frame(table(genre))
genre = genre[order(genre$Freq,decreasing=TRUE),]

# Top 20 genres with the most movies
ggplot(genre[1:20,], aes(x=reorder(factor(genre), Freq), y=Freq, alpha=Freq)) + 
  geom_bar(stat = "identity", fill="blue") + 
  geom_text(aes(label=Freq),hjust=1.2, size=3.5)+
  xlab("Genre") + 
  ylab("Number of Movies") + 
  ggtitle("Top 20 genres with the most movies") + 
  coord_flip()
```


Return on investment vs runtime of films:

```{r}
#Plot for ROI Vs run time
a <- ggplot(movie_metadata, aes(x = duration, y = (gross-budget))) +
  geom_point(alpha = 0.5, col = "darkgreen") + 
  ggtitle("ROI Vs Duration")+
  xlab("Duration (Minutes)")+
  ylab("") +
  geom_vline(xintercept = c(80,125),colour = c("blue","blue"))
  
#Zoomed Plot 
b <- ggplot(movie_metadata, aes(x = duration, y = (gross-budget))) +
  geom_point(alpha = 0.5, col = "darkgreen") + 
  ggtitle("Zoomed-in: 80 - 125 minutes duration")+
  xlab("Duration (Minutes)")+
  ylab("(ROI") +
  coord_cartesian(xlim = c(80, 125))

#To create two plots in the same window
ggarrange(a, b,  
          labels = c("A", "B"),
          ncol = 2, nrow = 1)
```

3. Top 20 genres with the most movies [ ]

>Summarizing the problem statement

Analyses on the monetary success and the likeability of movies were done to gather insights about the success of several movies.

>Summarizing the implementation

The data was scraped and manipulated accordingly for the analysis. The data was then reviewed graphically to determine what is the general trend in the movie industry, using scatter plots, line chart and bar charts.

>Summarizing the Analyses

There’s a linear trend between the profit earned and the budget of the movie.

There’s inverse relation between the Return on Investment and the Budget of a movie.

There is not much correlation between the profit earned and the imdb rating of the movie indicating that most critically acclaimed movies do not do much well commercially.

‘Drama’, ‘Romance’ and ‘Comedy’ are the most favorite genres among directors and producers.


> Genre VS Freq of movies
> Look at Link 4 for more inspo (LOL) Need to choose way to graph... mmmmmm... probs line graph?

