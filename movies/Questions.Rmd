---
title: "Questions"
author: "Luciaaaa"
date: "03/09/2019"
output: html_document
---

```{r setup, include=FALSE}
library(pacman)
pacman::p_load(dplyr, ggplot2, tidyr )
knitr::opts_chunk$set(echo = TRUE)
setwd(getwd())
```


```{r}
movie_metadata <- read.csv("../movie_metadata.csv", sep=";")
```

## Questions

Here is a list of questions we could play around with. Each title has "[ ]" on the side. If the question has been completed successfully, add an "X" inbetween the "[ ]", like "[X]". These questions have been arranged to URL links. Hopefully the source codes helps...

Also, read through ALLLLLL of the links. Let's start somewhere simple and work ourselves up. 

-----

### Link 1: https://rstudio-pubs-static.s3.amazonaws.com/384914_7bee8325659440ab9db1b3de36c37343.html

1. HeatMap [ ]
> Genre VS Year that Movie is Released


```{r}
revenue_data <- movie_metadata %>%
  filter(movie_metadata$gross >= 10000000 & movie_metadata$gross >= 10000000) %>%
  mutate(ROI = (gross - budget)/budget)

dim(revenue_data)
```


```{r}
revenue_data %>%
 filter(title_year > 2013) %>%  #Filter movies released after 2000
 group_by(title_year, genres) %>%
 summarise(count = n()) %>% #Count of Movies released
 ggplot(aes(title_year, as.factor(genres)))+
 geom_tile(aes(fill=count),colour="white")+
 scale_fill_gradient(low="light blue",high = "dark blue") +
 xlab("Year of Movie release")+
 ylab("Genre of Movie Release")+
 ggtitle("Heat Map")+
  theme(axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank())


revenue_data %>%
 filter(title_year > 2009) %>%  #Filter movies released after 1990
 group_by(year = title_year) %>%
 summarise(count = n()) %>% #Count of Movies released
 ggplot(aes(year)) +
 geom_tile(aes(fill=count),colour="white")+
 scale_fill_gradient(low="light blue",high = "dark blue") +
 xlab("Year of Movie release")+
 ylab("Month of Movie Release")+
 ggtitle("Heat Map")
```

2. Movie Budgets [ ]

```{r}
budget <- movie_metadata %>%
  select(movie_title, budget) %>%
  arrange(desc(budget)) %>%
  head(15)

x <- ggplot(budget, aes(x = reorder(movie_title, -desc(budget)), y = budget/1000000)) +
  geom_bar( stat = "identity")+ 
  theme(axis.text.x=element_text(hjust=1))+
  ggtitle("Movie Budgets")+
  xlab("")+
  ylab("Budget (in Millions)") + 
  coord_flip()

rev <- movie_metadata %>%
  select(movie_title, gross) %>%
  arrange(desc(gross)) %>%
  head(15)

y <- ggplot(rev, aes(x = (reorder(title, -desc(revenue))), y = gross/1000000)) +
  geom_bar( stat = "identity")+ 
  theme(axis.text.x=element_text(hjust=1))+
  ggtitle("Movie Revenues")+
  xlab("")+
  ylab("Revenue (in Millions)") + 
  coord_flip() 

ggarrange(x, y,
          labels = c("A", "B"),
          ncol = 1, nrow = 2)
```

3. Movie Gross [ ]
```{r}

```

4. 3D Plot [ ]
 IMDb Rating VS Budget VS Gross
```{r}

```

5. Vote counts over the years [ ]
```{r}
#Performing operations on Movies Vote Count over the years
 movies_vote1 <- movie_metadata %>%
 select(title_year, num_voted_users) %>%
 group_by(title_year) %>%
 summarise(count = sum(num_voted_users)) 

 names(movies_vote1) <- c("date","Number of voted users")

 ggplot(movies_vote1, aes(x = date, y = num_voted_users/1000)) +
 geom_bar( stat = "identity") +
 geom_vline(xintercept = c(1990,2004,2006),colour = c("orange","blue","red")) +
 ylab("Vote count (in thousands)") +
 xlab("Years") +
 annotate("text", label = "Facebook",x = 2003, y = 160, size = 3, colour = "blue",angle=90)+
 annotate("text", label = "IMDB",x = 1989, y = 160, size = 3, colour = "orange",angle=90)+
 annotate("text", label = "Twitter",x = 2005, y = 160, size = 3, colour = "red",angle=90)
```

6. Popularity over the years [ ]
```{r}
#Creating the required subset of data 
movies_pop <- movie_metadata %>%
 select(title_year, movie_facebook_likes) %>%
 filter(title_year > 1980) %>%
 group_by(title_year) %>%
 summarise(avg = mean(movie_facebook_likes)) 

 names(movies_pop) <- c("date","popularity")

 #generating the popularity Vs time plot
 ggplot(movies_pop, aes(x = date, y = movie_facebook_likes)) +
 geom_point() +
 geom_smooth() + 
 geom_vline(xintercept = c(1990,2004,2006),colour = c("orange","blue","red")) +
 ylab("Mean Popularity Score") +
 xlab("Years") +
 annotate("text", label = "Facebook",x = 2003, y = 80, size = 3, colour = "blue",angle=90)+
 annotate("text", label = "IMDB",x = 1989, y = 80, size = 3, colour = "orange",angle=90)+
 annotate("text", label = "Twitter",x = 2005, y = 80, size = 3, colour = "red",angle=90)
```

7. Distribution of Imdb Ratings
 Movie Count VS Imdb Ratings
```{r}
ggplot(movie_metadata, aes(imdb_score)) +
 geom_histogram(bins = 50) +
 geom_vline(xintercept = mean(movie_metadata$imdb_score,na.rm = TRUE),colour = "blue") +
 ylab("Movie Count") +
 xlab("IMDB Rating") +
 ggtitle("Histogram for IMDB ratings") +
  annotate("text", label = "Mean IMDB rating",x = 6.2, y = 50, size = 3, colour = "yellow",angle=90)
```

-----

### Link 2: https://rpubs.com/jasmine36/234304

1. Most Successfull Directors [ ]
> Director vs FB likes
> Director VS Gross
> Director VS Imdb
> Average Profit VS Number of Films (Points being Director)


2. Commercial Success VS Critical Acclaim [ ]
> Gross Money VS Imdb score (Profit being size of point; Point Colour being rating)
> Also available on: http://rstudio-pubs-static.s3.amazonaws.com/342210_7c8d57cfdd784cf58dc077d3eb7a2ca3.html

```{r}
movie_metadata %>%
  filter(imdb_score >5 ) %>% #Filter to show the graph only for vote_average values greater than 5
 ggplot(aes(x = imdb_score, y = (gross-budget))) + #ROI == gross - budget #LUCIA PLEASE FIX:)
  geom_point(alpha = 0.5, col = "darkgreen") + 
  theme(axis.text.x=element_text(hjust=1))+
  ggtitle("ROI Vs avg_rating")+
  xlab("rating ")+
  ylab("") +
  geom_smooth()
```
Return on investment vs runtime of films:

```{r}
#Plot for ROI Vs run time
a <- ggplot(movie_metadata, aes(x = duration, y = (gross-budget))) +
  geom_point(alpha = 0.5, col = "darkgreen") + 
  ggtitle("ROI Vs Duration")+
  xlab("Duration (Minutes)")+
  ylab("") +
  geom_vline(xintercept = c(80,125),colour = c("blue","blue"))
  
#Zoomed Plot 
b <- ggplot(movie_metadata, aes(x = duration, y = (gross-budget))) +
  geom_point(alpha = 0.5, col = "darkgreen") + 
  ggtitle("Zoomed-in: 80 - 125 minutes duration")+
  xlab("Duration (Minutes)")+
  ylab("(ROI") +
  coord_cartesian(xlim = c(80, 125))

#To create two plots in the same window
ggarrange(a, b,  
          labels = c("A", "B"),
          ncol = 2, nrow = 1)
```

3. Top 20 genres with the most movies [ ]

```{r}

movie_metadata %>%
  filter()


```

> Genre VS Freq of movies
> Look at Link 4 for more inspo (LOL) Need to choose way to graph... mmmmmm... probs line graph?

-----

### Link 3: http://rstudio-pubs-static.s3.amazonaws.com/342210_7c8d57cfdd784cf58dc077d3eb7a2ca3.html
Literally works on our data, however, this link does a lot of pre-processing that we might need to take a look at. For example, they use the first word in the genre column as the genre of the movie. 

1. Number of Movies Produced Per Year [ ]
> Count of movies VS Year

2. Most Successfull Directors [ ]
> Table representation of Director and their average IMDb rating

3. Relationship between number of FB likes and Imdb score [ ]
> Imdb score VS movie FB likes

4. Correlation Heatmap [ ]

5. Full-Grown Tree [ ]
> Random Forest
> K-Nearest Neighbour




-----

#### Link 4: https://www.kaggle.com/karrrimba/understanding-movies-through-data
Literally works on our data. A lot of code to look trough. 

1. Genre wise share of movies for top 10 genres [ ]

2. Genre wise distribution of scores [ ]
> All genres with Imdb rating distribution

3. Bar chart for 10 highest rated genres [ ]
> Genres VS Average IMDB Score

4. Bar chart for 10 most voted genres [ ]
> Genres VS Average User Votes

5. Bar chart for 10 most FB liked genres [ ]
> Genres VS Average Facebook Likes

6. Distribution of budget and gross [ ]

7. Share of movies making profit or loss [ ]
> Did profitable movies recieve more appreciation by the users?

8. Line Graph for Avg Score/Avg Votes/Avg User Review by Title Year [ ]

9. Scatter plot for User Votes vs IMDB Score [ ]
> User Votes VS IMDB Score

10. Box plot for User Votes vs IMDB Score
> IMDB Score VS User Votes

_____


### Other Analysis Questions

1. Rating VS Budget [ ]

2. Rating VS Gross [ ]

3. Budget VS Gross [ ]

4. Most Successful/Unsuccessful Movies
> Based on their ratings

5. Highest Rated Actor
> Movie VS Imdb Score
> Most Popular Actor: Based on FB likes

-----


